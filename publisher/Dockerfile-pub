FROM node:21-alpine3.18

ENV MQTT_BROKER_HOST ${MQTT_BROKER_HOST}
ENV MQTT_BROKER_PORT ${MQTT_BROKER_PORT}
ENV MQTT_BROKER_USER ${MQTT_BROKER_USER}
ENV MQTT_BROKER_PWD  ${MQTT_BROKER_PWD}
ENV PUBLISHER_PORT  ${PUBLISHER_PORT}

WORKDIR /usr/src/app

COPY package*.json ./

RUN yarn install

COPY . .

EXPOSE ${PUBLISHER_PORT}

CMD [ "node", "index.js" ]